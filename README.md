# Cron Webhooks

Web App with webhook registration that allows callers to subscribe to cron notification in the form of webhooks.

# Technical Reference

## ASP.NET Core

* [Background Tasks with Hosted Services in ASP.NET Core](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/host/hosted-services?view=aspnetcore-7.0&tabs=visual-studio)
* [Minimal API Quick Reference](https://learn.microsoft.com/en-us/aspnet/core/fundamentals/minimal-apis?view=aspnetcore-7.0)
* [Tutorial: Create a Minimal API using ASP.NET Core](https://learn.microsoft.com/en-us/aspnet/core/tutorials/min-web-api?view=aspnetcore-7.0&tabs=visual-studio)

# Notes

* [Use a WebHook to configure health notifications for problem management systems](https://docs.microsoft.com/en-us/azure/service-health/service-health-alert-webhook-guide)
* [Webhooks for activity log alerts](https://docs.microsoft.com/en-us/azure/azure-monitor/alerts/activity-log-alerts-webhook)
* [ASP.NET WebHook Development](https://learn.microsoft.com/en-us/aspnet/webhooks/)
  > To ensure that the WebHook is indeed from the intended sender, the POST request is secured in some way and then verified by the receiver. For example, GitHub WebHooks includes an X-Hub-Signature HTTP header with a hash of the request body which is checked by the receiver implementation so you don't have to worry about it.
  * [Source code and Nuget Packages](https://learn.microsoft.com/en-us/aspnet/webhooks/source)
    * [Sender: Microsoft.AspNet.WebHooks.Custom](https://www.nuget.org/packages?q=Microsoft.AspNet.WebHooks.Custom)
    * [Microsoft.AspNet.WebHooks.Receivers](https://www.nuget.org/packages?q=Microsoft.AspNet.WebHooks.Receivers)
    * [Shared: Microsoft.AspNet.WebHooks.Common](https://www.nuget.org/packages?q=Microsoft.AspNet.WebHooks.Common)
* [About Github Webhooks](https://docs.github.com/en/developers/webhooks-and-events/webhooks/about-webhooks)
  * [Github Webhook Events and Payloads](https://docs.github.com/en/enterprise-server@3.6/webhooks/webhook-events-and-payloads)
* [Monitor GitHub events by using a webhook with Azure Functions](https://learn.microsoft.com/en-us/training/modules/monitor-github-events-with-a-function-triggered-by-a-webhook/)
* [HMACSHA256](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.hmacsha256?view=net-5.0)
* [Webhook Consumer with Azure Functions](https://www.sparkpost.com/blog/azure-functions/)
  > "Webhook consumers should run asynchronously. The data should be ingested as quickly as possible and then processed."
  * This generally means that webhook trigger writes to a topic and a separate Webhook Processor actually performs actions based on topic contents.

:warning: Webhook development may include several up-front challenges that may be difficult for developers to overcome, as it's near impossible to build proper callbacks hosted on "localhost".


Notes:
* no innate auth call -- Webhooks are outgoing. Think about receiving a phone call. The caller doesn't authenticate with you. Generally you have an existing signature or shared key -- In my case, Is their number in my contact list? Similarly, rather establish a private signature token that the incoming call can be validated against using HMAC.
* [HMACSHA256](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.hmacsha256?view=net-5.0) signature key to be stored along with the webhook registration. Also shared with the webhook registrar, but protected. Can be re-generated by registrar.
  * [ngrok reverse proxy](https://ngrok.com/) as a possible callback hooks solution 
    * :warning: ngrok may be blocked by corporate firewalls as a security risk.
* Self registration including self-management of topic subscriptions. Separate permissions for management vs. triggering. 
* Separation of event + publication of event. 
* At least once delivery. 
* Representative test events, can be sent on request. 
* how to develop and test locally – webhooks need a reverse proxy? ngrok for example. 
* [Reddit: Architecture help/pointers for webhooks/web api](https://www.reddit.com/r/dotnet/comments/upjmpn/architecture_helppointers_for_webhooksweb_api/?utm_source=share&utm_medium=ios_app&utm_name=iossmf)
